You are correct. The previous response provided the instructions for the changes, but didn't provide the complete updated code.

Here is the **complete and updated EJS code** for your scheme index page (likely `views/schemes/index.ejs`), incorporating the Admin/User role-based visibility checks for the "Add New Scheme," "Edit," and "Delete" actions.

```ejs
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>All Schemes | SchemeMate</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Simple fixed positioning for the chat button */
        #chat-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        /* Style for the chat panel */
        #chat-panel {
            position: fixed;
            bottom: 90px;
            right: 20px;
            z-index: 1000;
            width: 90vw;
            max-width: 400px;
            height: 60vh;
            max-height: 500px;
        }
        /* Custom scrollbar for chat history */
        #chat-history {
            overflow-y: auto;
            scroll-behavior: smooth;
        }
        #chat-history::-webkit-scrollbar {
            width: 8px;
        }
        #chat-history::-webkit-scrollbar-thumb {
            background-color: #9ca3af; /* gray-400 */
            border-radius: 4px;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

    <%- include('../partials/flash', { success: success, error: error }) %>
    
    <header class="bg-blue-700 text-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center p-4">
            <div class="flex items-center space-x-3">
                <img src="/images/logo.png" alt="SchemeMate Logo" class="w-10 h-10 rounded-full">
                <h1 class="text-2xl font-bold">SchemeMate</h1>
            </div>

            <nav class="hidden md:flex space-x-6">
                <a href="/" class="hover:text-gray-200 font-medium">Home</a>
                <a href="/schemes/about" class="hover:text-gray-200 font-medium">About Us</a>
                <a href="/schemes/contact" class="hover:text-gray-200 font-medium">Contact</a>
                <a href="/schemes" class="hover:text-gray-200 font-medium">Schemes</a>
                <% if (currentUser && currentUser.role === 'admin') { %>
                    <a href="/schemes/new" class="hover:text-gray-200 font-medium border-l pl-6 border-blue-500">Add New Scheme</a>
                <% } %>
                </nav>

            <button id="menu-btn" class="md:hidden focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
        </div>

        <nav id="mobile-menu" class="md:hidden hidden flex-col space-y-3 bg-blue-600 px-6 pb-4">
            <a href="/" class="block hover:text-gray-200 font-medium">Home</a>
            <a href="/schemes/about" class="block hover:text-gray-200 font-medium">About Us</a>
            <a href="/schemes/contact" class="block hover:text-gray-200 font-medium">Contact</a>
            <a href="/schemes" class="block hover:text-gray-200 font-medium">Schemes</a>
            <% if (currentUser && currentUser.role === 'admin') { %>
                <a href="/schemes/new" class="block hover:text-gray-200 font-medium">Add New Scheme</a>
            <% } %>
            </nav>
    </header>

    <script>
        const menuBtn = document.getElementById('menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        menuBtn.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
    </script>

    <main>
        <section class="bg-blue-100 py-14 text-center">
            <h2 class="text-4xl md:text-5xl font-bold text-blue-800 mb-4">
                <% if (currentCategory) { %>
                    Schemes for <%= currentCategory %>
                <% } else if (currentQuery) { %>
                    Search Results for "<%= currentQuery %>"
                <% } else { %>
                    All Medical Schemes 
                <% } %>
            </h2>
            <p class="text-lg text-gray-700 max-w-2xl mx-auto">
                Explore verified healthcare and medical benefit schemes designed to make healthcare more accessible.
            </p>
        </section>

        <div class="container mx-auto px-6 my-8">
            <form action="/schemes" method="GET" class="flex flex-col md:flex-row gap-4 items-center">
                <input type="text" name="q" placeholder="Search by scheme title or description..." 
                        value="<%= currentQuery %>"
                        class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                
                <button type="submit" class="bg-blue-700 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-800 transition md:w-auto">
                    Search
                </button>
            </form>
        </div>

        <div class="container mx-auto text-center my-10">
            <% if (currentUser && currentUser.role === 'admin') { %>
                <a href="/schemes/new" class="bg-blue-700 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-800 transition">
                    + Add New Scheme
                </a>
            <% } %>
        </div>
        <div class="container mx-auto px-6 grid gap-8 sm:grid-cols-2 lg:grid-cols-3 mb-16">
            
            <% if (listings.length === 0) { %>
                <div class="lg:col-span-3 text-center py-10 bg-white rounded-xl shadow-lg">
                    <p class="text-xl text-gray-600">No schemes found matching your criteria. Try a different search term or category.</p>
                </div>
            <% } %>

            <% listings.forEach(scheme => { %>
                <div class="bg-white rounded-2xl shadow-lg hover:shadow-xl transition transform hover:-translate-y-1 p-6 flex flex-col justify-between border-t-4 border-blue-500">
                    <div>
                        <span class="text-xs font-semibold uppercase px-3 py-1 rounded-full bg-blue-100 text-blue-700 mb-3 inline-block">
                            <%= scheme.category || 'General' %>
                        </span>
                        
                        <h3 class="text-2xl font-semibold text-blue-700 mb-2"><%= scheme.title %></h3>
                        <p class="text-gray-700 mb-3 line-clamp-3"><%= scheme.description %></p>
                        
                        <p class="font-bold text-green-600 mb-2 text-lg">
                            Benefit: 
                            <% 
                                if (typeof scheme.benefitAmount === 'number') {
                                    %> ‚Çπ<%= scheme.benefitAmount.toLocaleString('en-IN') %> <%
                                } else {
                                    %> <%= scheme.benefitAmount %> <%
                                }
                            %>
                        </p>
                        
                        <p class="text-sm text-gray-500 mb-4">üìç Location: <%= scheme.location || 'Pan India' %></p>
                        <p class="text-sm text-gray-500 mb-4 line-clamp-2">Eligibility: <%= scheme.eligibility || 'N/A' %></p>

                    </div>
                    
                    <div class="flex flex-wrap gap-3 mt-auto border-t pt-4">
                        <a href="/schemes/<%= scheme._id %>" class="bg-gray-300 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-400 transition text-sm font-medium">
                            View Details
                        </a>

                        <% if (scheme.infoLink) { %>
                            <a href="<%= scheme.infoLink %>" target="_blank" class="bg-blue-700 text-white px-4 py-2 rounded-md hover:bg-blue-800 transition text-sm font-medium">
                                Official Link
                            </a>
                        <% } %>
                        
                        <% if (currentUser && currentUser.role === 'admin') { %>
                            <a href="/schemes/<%= scheme._id %>/edit" class="bg-yellow-500 text-white px-4 py-2 rounded-md hover:bg-yellow-600 transition text-sm font-medium">
                                Edit
                            </a>
                            <form action="/schemes/delete/<%= scheme._id %>?_method=DELETE" method="POST" class="inline" onsubmit="return confirm('Are you sure you want to delete this scheme?');">
                                <button type="submit" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition text-sm font-medium">
                                    Delete
                                </button>
                            </form>
                        <% } %>
                        </div>
                </div>
            <% }) %>
        </div>
    </main>

    <footer class="bg-blue-800 text-white mt-16">
        <div class="container mx-auto px-6 py-10 grid md:grid-cols-4 gap-8">
            
            <div>
                <h4 class="font-bold text-lg mb-4">SchemeMate</h4>
                <p class="text-gray-200 text-sm">
                    SchemeMate helps you explore verified medical and health benefit schemes, empowering citizens with accurate information about healthcare options.
                </p>
            </div>

            <div>
                <h4 class="font-bold text-lg mb-4">Quick Links</h4>
                <ul class="space-y-2">
                    <li><a href="/" class="hover:text-gray-300">Home</a></li>
                    <li><a href="/schemes/about" class="hover:text-gray-300">About Us</a></li>
                    <li><a href="/schemes/contact" class="hover:text-gray-300">Contact</a></li>
                    <li><a href="/schemes" class="hover:text-gray-300">Schemes</a></li>
                </ul>
            </div>

            <div>
                <h4 class="font-bold text-lg mb-4">Contact</h4>
                <p class="text-gray-200 text-sm">Email: info@schememate.com</p>
                <p class="text-gray-200 text-sm">Phone: +91 123 456 7890</p>
                <p class="text-gray-200 text-sm">Location: India</p>
            </div>

            <div>
                <h4 class="font-bold text-lg mb-4">Follow Us</h4>
                <div class="flex space-x-4 text-2xl">
                    <a href="#" class="hover:text-gray-300">üåê</a>
                    <a href="#" class="hover:text-gray-300">üê¶</a>
                    <a href="#" class="hover:text-gray-300">üìò</a>
                    <a href="#" class="hover:text-gray-300">üì∏</a>
                </div>
            </div>

        </div>

        <div class="bg-blue-900 text-center text-gray-300 py-4 text-sm">
            &copy; <%= new Date().getFullYear() %> SchemeMate | All Rights Reserved
        </div>
    </footer>

    <button id="chat-button" class="bg-red-500 hover:bg-red-600 text-white p-4 rounded-full shadow-lg transition transform hover:scale-110 focus:outline-none">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h.01M12 10h.01M16 10h.01M3 20V4a2 2 0 012-2h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2z" />
        </svg>
    </button>

    <div id="chat-panel" class="hidden bg-white rounded-xl shadow-2xl flex flex-col border border-gray-200 overflow-hidden">
        
        <div class="bg-blue-700 text-white p-3 flex justify-between items-center shadow-md">
            <h5 class="font-bold">ü§ñ SchemeBot</h5>
            <button id="close-chat-btn" class="text-white hover:text-gray-300 focus:outline-none">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                </svg>
            </button>
        </div>

        <div id="chat-history" class="flex-grow p-4 space-y-4 bg-gray-50">
            <div class="flex justify-start">
                <div class="bg-blue-100 text-blue-800 p-3 rounded-lg max-w-xs shadow">
                    <p class="font-medium">Hello! I'm **SchemeBot**, your AI assistant for SchemeMate. Ask me anything about health, education, or farmer schemes!</p>
                </div>
            </div>
            </div>

        <form id="chat-form" class="p-3 border-t border-gray-200 bg-white">
            <div class="flex space-x-2">
                <input type="text" id="chat-input" placeholder="Ask SchemeBot..." required 
                        class="flex-grow p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                <button type="submit" id="send-button" class="bg-blue-700 text-white p-2 rounded-lg hover:bg-blue-800 disabled:bg-gray-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transform rotate-90" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                    </svg>
                </button>
            </div>
        </form>
    </div>

    <script>
        const chatButton = document.getElementById('chat-button');
        const chatPanel = document.getElementById('chat-panel');
        const closeChatBtn = document.getElementById('close-chat-btn');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const chatHistory = document.getElementById('chat-history');
        const sendButton = document.getElementById('send-button');
        
        // --- 1. Toggle Chat Panel ---
        chatButton.addEventListener('click', () => {
            chatPanel.classList.toggle('hidden');
        });

        closeChatBtn.addEventListener('click', () => {
            chatPanel.classList.add('hidden');
        });

        // --- 2. Message Rendering Functions ---
        const renderMessage = (message, isUser = false) => {
            const messageContainer = document.createElement('div');
            messageContainer.classList.add('flex', isUser ? 'justify-end' : 'justify-start');

            const messageBubble = document.createElement('div');
            messageBubble.classList.add('p-3', 'rounded-lg', 'max-w-xs', 'shadow');
            messageBubble.classList.add(isUser 
                ? 'bg-blue-700' : 'bg-blue-100', isUser ? 'text-white' : 'text-blue-800'
            );

            // Simple markdown-to-HTML conversion for bold text
            const formattedMessage = message.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            messageBubble.innerHTML = formattedMessage;

            messageContainer.appendChild(messageBubble);
            chatHistory.appendChild(messageContainer);

            // Scroll to the bottom of the chat history
            chatHistory.scrollTop = chatHistory.scrollHeight;
        };

        // --- 3. Handle Form Submission and API Call ---
        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const userMessage = chatInput.value.trim();

            if (!userMessage) return;

            // Display user message
            renderMessage(userMessage, true);
            chatInput.value = '';

            // Disable input and button while waiting for response
            chatInput.disabled = true;
            sendButton.disabled = true;

            // Add a "typing..." indicator (optional, but good UX)
            const typingIndicatorId = 'typing-' + Date.now();
            const typingIndicator = document.createElement('div');
            typingIndicator.id = typingIndicatorId;
            typingIndicator.classList.add('flex', 'justify-start');
            typingIndicator.innerHTML = '<div class="bg-gray-200 text-gray-700 p-3 rounded-lg max-w-xs shadow">... typing ...</div>';
            chatHistory.appendChild(typingIndicator);
            chatHistory.scrollTop = chatHistory.scrollHeight;

            try {
                const response = await fetch('/api/gemini-chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message: userMessage }),
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                // Remove the "typing..." indicator
                document.getElementById(typingIndicatorId)?.remove();

                // Display bot reply
                renderMessage(data.reply);

            } catch (error) {
                console.error("Chatbot API Error:", error);
                
                // Remove the "typing..." indicator if it's still there
                document.getElementById(typingIndicatorId)?.remove();
                
                // Display error message from client side
                renderMessage("Sorry, I couldn't connect to the AI service. Please check the server logs.", false);
            } finally {
                // Re-enable input and button
                chatInput.disabled = false;
                sendButton.disabled = false;
                chatInput.focus();
            }
        });

    </script>
</body>
</html>
```